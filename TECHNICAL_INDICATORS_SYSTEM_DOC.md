# åŠ å¯†è´§å¸æŠ€æœ¯æŒ‡æ ‡åˆ†æç³»ç»Ÿ - æŠ€æœ¯æ–‡æ¡£

> ç‰ˆæœ¬: v2.3.0
> æ›´æ–°æ—¶é—´: 2025-09-18
> ä½œè€…: Claude Code AI Assistant

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
3. [æ•°æ®æºä¸æ•°æ®æµ](#æ•°æ®æºä¸æ•°æ®æµ)
4. [æ ¸å¿ƒç»„ä»¶è¯¦è§£](#æ ¸å¿ƒç»„ä»¶è¯¦è§£)
5. [æŠ€æœ¯æŒ‡æ ‡å®ç°é€»è¾‘](#æŠ€æœ¯æŒ‡æ ‡å®ç°é€»è¾‘)
6. [ä¿¡å·åˆ†ææµç¨‹](#ä¿¡å·åˆ†ææµç¨‹)
7. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
8. [ç¼“å­˜ç­–ç•¥è¯¦è§£](#ç¼“å­˜ç­–ç•¥è¯¦è§£)
9. [APIæ¥å£è¯´æ˜](#apiæ¥å£è¯´æ˜)
10. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
11. [éƒ¨ç½²ä¸é…ç½®](#éƒ¨ç½²ä¸é…ç½®)
12. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

---

## ç³»ç»Ÿæ¦‚è¿°

### ğŸ¯ ç³»ç»Ÿç›®æ ‡

æœ¬æŠ€æœ¯æŒ‡æ ‡åˆ†æç³»ç»Ÿæ—¨åœ¨ä¸ºåŠ å¯†è´§å¸Telegramæœºå™¨äººæä¾›**å®æ—¶ã€å‡†ç¡®ã€é«˜æ€§èƒ½**çš„æŠ€æœ¯åˆ†æåŠŸèƒ½ï¼Œæ”¯æŒå¤šç§ä¸»æµæŠ€æœ¯æŒ‡æ ‡çš„è®¡ç®—ã€ä¿¡å·åˆ†æå’Œç»¼åˆå†³ç­–å»ºè®®ã€‚

### ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

- **å¤šæŒ‡æ ‡æ”¯æŒ**: RSI, MACD, ç§»åŠ¨å¹³å‡çº¿, å¸ƒæ—å¸¦, KDJ, å¨å»‰æŒ‡æ ‡ç­‰
- **å®æ—¶æ•°æ®è·å–**: åŸºäºå¸å®‰APIçš„Kçº¿æ•°æ®æœåŠ¡
- **æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ**: å¤šå±‚ç¼“å­˜ä¼˜åŒ–ï¼Œæå‡å“åº”é€Ÿåº¦
- **ä¿¡å·ç»¼åˆåˆ†æ**: å¤šæŒ‡æ ‡ä¿¡å·ç»¼åˆè¯„ä¼°å’Œå†³ç­–å»ºè®®
- **æ€§èƒ½ç›‘æ§**: å®æ—¶æ€§èƒ½ç›‘æ§å’Œè‡ªåŠ¨ä¼˜åŒ–å»ºè®®
- **æ‰¹å¤„ç†ä¼˜åŒ–**: é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ‰¹é‡å¤„ç†èƒ½åŠ›

### ğŸ“Š æŠ€æœ¯æ ˆ

```
TypeScript + Node.js
â”œâ”€â”€ ä¾èµ–æ³¨å…¥: inversify
â”œâ”€â”€ æµ‹è¯•æ¡†æ¶: Jest
â”œâ”€â”€ APIæ•°æ®æº: Binance API
â”œâ”€â”€ ç¼“å­˜ç­–ç•¥: å†…å­˜ç¼“å­˜ + TTL
â””â”€â”€ æ€§èƒ½ç›‘æ§: è‡ªç ”æ€§èƒ½ä¼˜åŒ–å™¨
```

---

## ç³»ç»Ÿæ¶æ„

### ğŸ—ï¸ æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Telegram Bot Layer                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  /signals cmd   â”‚  â”‚   Bot Menus     â”‚  â”‚  Help Sys   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Technical Indicators Engine                   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Signal Analyzer â”‚  â”‚ Indicator Cache â”‚  â”‚ OHLCV Data  â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚    Service      â”‚  â”‚   Service   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ Batch Processor â”‚  â”‚ Performance     â”‚                  â”‚
â”‚  â”‚                 â”‚  â”‚   Optimizer     â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Data Layer                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Binance API    â”‚  â”‚   Cache Layer   â”‚  â”‚ Service     â”‚ â”‚
â”‚  â”‚    Client       â”‚  â”‚                 â”‚  â”‚ Registry    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”€ ä¾èµ–æ³¨å…¥æ¶æ„

ç³»ç»Ÿé‡‡ç”¨**inversify**è¿›è¡Œä¾èµ–æ³¨å…¥ç®¡ç†ï¼Œæ‰€æœ‰æ ¸å¿ƒæœåŠ¡é€šè¿‡DIå®¹å™¨æ³¨å†Œå’Œè§£æï¼š

```typescript
SERVICE_IDENTIFIERS = {
  // æŠ€æœ¯æŒ‡æ ‡æ ¸å¿ƒæœåŠ¡
  TECHNICAL_INDICATOR_ENGINE: Symbol('TechnicalIndicatorEngine'),
  SIGNAL_ANALYZER: Symbol('SignalAnalyzer'),
  INDICATOR_CACHE_SERVICE: Symbol('IndicatorCacheService'),
  OHLCV_DATA_SERVICE: Symbol('OHLCVDataService'),

  // æ€§èƒ½ä¼˜åŒ–æœåŠ¡
  PERFORMANCE_OPTIMIZER: Symbol('PerformanceOptimizer'),
  BATCH_PROCESSOR: Symbol('BatchProcessor'),

  // åŸºç¡€æœåŠ¡
  BINANCE_CLIENT: Symbol('BinanceClient')
}
```

---

## æ•°æ®æºä¸æ•°æ®æµ

### ğŸ“ˆ ä¸»è¦æ•°æ®æº

#### 1. **å¸å®‰API (Binance API)**
- **ç°è´§Kçº¿æ•°æ®**: `/api/v3/klines`
- **åˆçº¦Kçº¿æ•°æ®**: `/fapi/v1/klines`
- **æ”¯æŒæ—¶é—´æ¡†æ¶**: 1m, 5m, 15m, 30m, 1h, 4h, 1d, 1w, 1M
- **æ•°æ®æ ¼å¼**: OHLCV (å¼€ç›˜ä»·ã€æœ€é«˜ä»·ã€æœ€ä½ä»·ã€æ”¶ç›˜ä»·ã€æˆäº¤é‡)

#### 2. **æ•°æ®ç»“æ„å®šä¹‰**

```typescript
interface OHLCV {
  timestamp: number;    // æ—¶é—´æˆ³
  open: number;        // å¼€ç›˜ä»·
  high: number;        // æœ€é«˜ä»·
  low: number;         // æœ€ä½ä»·
  close: number;       // æ”¶ç›˜ä»·
  volume: number;      // æˆäº¤é‡
}
```

### ğŸ”„ æ•°æ®æµç¨‹å›¾

```
ç”¨æˆ·å‘½ä»¤(/signals BTC)
        â†“
   å‚æ•°è§£æä¸éªŒè¯
        â†“
   æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨ â”€â”€â†’ [ç¼“å­˜å‘½ä¸­] â†’ è¿”å›ç¼“å­˜ç»“æœ
        â†“ [ç¼“å­˜æœªå‘½ä¸­]
   è°ƒç”¨OHLCVDataService
        â†“
   ä»å¸å®‰APIè·å–Kçº¿æ•°æ®
        â†“
   æ•°æ®æ ¼å¼è½¬æ¢(Kline â†’ OHLCV)
        â†“
   ç¼“å­˜åŸå§‹æ•°æ®
        â†“
   æŠ€æœ¯æŒ‡æ ‡è®¡ç®—(å¹¶è¡Œ)
        â†“
   ä¿¡å·åˆ†æä¸ç»¼åˆè¯„ä¼°
        â†“
   ç¼“å­˜åˆ†æç»“æœ
        â†“
   æ ¼å¼åŒ–è¾“å‡ºç»™ç”¨æˆ·
```

### âš¡ æ•°æ®è·å–ä¼˜åŒ–

- **å¹¶è¡Œè·å–**: å¤šä¸ªæ—¶é—´æ¡†æ¶æ•°æ®å¹¶è¡Œè·å–
- **æ™ºèƒ½ç¼“å­˜**: æ ¹æ®æ—¶é—´æ¡†æ¶åŠ¨æ€è°ƒæ•´TTL
- **æ‰¹å¤„ç†**: å¤šä¸ªæŒ‡æ ‡è®¡ç®—åˆå¹¶ä¸ºæ‰¹æ¬¡å¤„ç†
- **é”™è¯¯æ¢å¤**: APIå¤±è´¥æ—¶çš„ä¼˜é›…é™çº§æœºåˆ¶

---

## æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. **OHLCVDataService** - æ•°æ®è·å–æœåŠ¡

**èŒè´£**: è´Ÿè´£ä»å¸å®‰APIè·å–å’Œç¼“å­˜Kçº¿æ•°æ®

**æ ¸å¿ƒç‰¹æ€§**:
```typescript
class OHLCVDataService {
  // æ™ºèƒ½ç¼“å­˜TTLé…ç½®
  private CACHE_TTL = {
    '1m': 45 * 1000,     // 45ç§’
    '5m': 3 * 60 * 1000, // 3åˆ†é’Ÿ
    '15m': 8 * 60 * 1000, // 8åˆ†é’Ÿ
    // ... å…¶ä»–æ—¶é—´æ¡†æ¶
  };

  // æ ¸å¿ƒæ–¹æ³•
  async getOHLCVData(symbol, timeframe, limit?, startTime?, endTime?, market?)
  async getLatestOHLCV(symbol, timeframe, market?)
  async getMultiTimeframeData(symbol, timeframes[], limit?, market?)
}
```

**æ€§èƒ½ç‰¹æ€§**:
- æ”¯æŒç°è´§å’Œåˆçº¦å¸‚åœº
- è‡ªåŠ¨é‡è¯•æœºåˆ¶
- è¯·æ±‚é€Ÿç‡é™åˆ¶
- æ•°æ®éªŒè¯å’Œæ¸…æ´—

### 2. **TechnicalIndicatorEngine** - æŠ€æœ¯æŒ‡æ ‡å¼•æ“

**èŒè´£**: ç®¡ç†æ‰€æœ‰æŠ€æœ¯æŒ‡æ ‡çš„æ³¨å†Œã€è®¡ç®—å’Œä¿¡å·åˆ†æ

**æ¶æ„è®¾è®¡**:
```typescript
interface ITechnicalIndicator {
  readonly name: string;
  readonly description: string;
  readonly requiredPeriods: number;

  calculate(data: OHLCV[], params?: IndicatorParams): IndicatorResult;
  getSignal(result: IndicatorResult, params?: IndicatorParams): SignalResult;
  validateParams(params: IndicatorParams): boolean;
  getDefaultParams(): IndicatorParams;
}
```

**æ”¯æŒçš„æŒ‡æ ‡ç±»å‹**:
- **è¶‹åŠ¿æŒ‡æ ‡**: ç§»åŠ¨å¹³å‡çº¿(MA), MACD
- **åŠ¨é‡æŒ‡æ ‡**: RSI, KDJ, å¨å»‰æŒ‡æ ‡(WR)
- **æ³¢åŠ¨æ€§æŒ‡æ ‡**: å¸ƒæ—å¸¦(BB)
- **æˆäº¤é‡æŒ‡æ ‡**: æˆäº¤é‡ç§»åŠ¨å¹³å‡

### 3. **IndicatorCacheService** - æ™ºèƒ½ç¼“å­˜æœåŠ¡

**èŒè´£**: æä¾›é«˜æ€§èƒ½çš„æŠ€æœ¯æŒ‡æ ‡ç»“æœç¼“å­˜åŠŸèƒ½

**ç¼“å­˜å±‚çº§**:
```typescript
enum CacheType {
  OHLCV = 'ohlcv',           // Kçº¿æ•°æ®ç¼“å­˜
  INDICATOR = 'indicator',    // æŒ‡æ ‡è®¡ç®—ç»“æœç¼“å­˜
  SIGNAL = 'signal',         // ä¿¡å·åˆ†æç»“æœç¼“å­˜
  COMPOSITE = 'composite'     // ç»¼åˆä¿¡å·ç¼“å­˜
}
```

**ç¼“å­˜ç­–ç•¥**:
- **åˆ†å±‚TTL**: ä¸åŒç±»å‹æ•°æ®ä½¿ç”¨ä¸åŒè¿‡æœŸæ—¶é—´
- **LRUæ·˜æ±°**: å†…å­˜ä½¿ç”¨è¾¾åˆ°é™åˆ¶æ—¶æ™ºèƒ½æ·˜æ±°
- **ç»Ÿè®¡ç›‘æ§**: ç¼“å­˜å‘½ä¸­ç‡å’Œæ€§èƒ½ç»Ÿè®¡
- **è‡ªåŠ¨æ¸…ç†**: å®šæœŸæ¸…ç†è¿‡æœŸç¼“å­˜

### 4. **SignalAnalyzer** - ä¿¡å·ç»¼åˆåˆ†æå™¨

**èŒè´£**: ç»¼åˆå¤šä¸ªæŠ€æœ¯æŒ‡æ ‡ä¿¡å·ï¼Œæä¾›æŠ•èµ„å†³ç­–å»ºè®®

**åˆ†æç­–ç•¥**:
```typescript
interface AnalysisStrategy {
  name: string;
  description: string;
  weights: SignalWeight[];    // æŒ‡æ ‡æƒé‡é…ç½®
  riskAdjustment: number;    // é£é™©è°ƒæ•´ç³»æ•°
}

// å†…ç½®ç­–ç•¥
strategies = {
  'balanced': 'å¹³è¡¡ç­–ç•¥ - å‡ç­‰æƒé‡æ‰€æœ‰æŒ‡æ ‡',
  'momentum': 'åŠ¨é‡ç­–ç•¥ - é‡ç‚¹å…³æ³¨åŠ¨é‡æŒ‡æ ‡',
  'trend': 'è¶‹åŠ¿ç­–ç•¥ - é‡ç‚¹å…³æ³¨è¶‹åŠ¿æŒ‡æ ‡',
  'conservative': 'ä¿å®ˆç­–ç•¥ - è¾ƒé«˜å¯é æ€§æƒé‡',
  'aggressive': 'æ¿€è¿›ç­–ç•¥ - é«˜é£é™©é«˜æ”¶ç›Š'
}
```

**ç»¼åˆè¯„åˆ†ç®—æ³•**:
1. **æŒ‡æ ‡åŠ æƒ**: æ ¹æ®ç­–ç•¥æƒé‡è®¡ç®—å„æŒ‡æ ‡å¾—åˆ†
2. **æ—¶é—´æ¡†æ¶è°ƒæ•´**: ä¸åŒæ—¶é—´æ¡†æ¶çš„æ•æ„Ÿåº¦è°ƒæ•´
3. **å¯é æ€§ä¿®æ­£**: åŸºäºæŒ‡æ ‡å†å²å‡†ç¡®ç‡è°ƒæ•´
4. **å¸‚åœºæƒ…ç»ªåˆ†æ**: ç»“åˆææ…Œè´ªå©ªæŒ‡æ•°
5. **é£é™©è¯„ä¼°**: æ³¢åŠ¨æ€§å’Œé£é™©å› å­åˆ†æ

---

## æŠ€æœ¯æŒ‡æ ‡å®ç°é€»è¾‘

### ğŸ“Š RSI (ç›¸å¯¹å¼ºå¼±æŒ‡æ•°)

**ç®—æ³•å®ç°**:
```typescript
calculate(data: OHLCV[], params: {period: 14}): IndicatorResult {
  const changes = this.getPriceChanges(this.getClosePrices(data));
  const gains = changes.map(change => change > 0 ? change : 0);
  const losses = changes.map(change => change < 0 ? -change : 0);

  const avgGains = this.calculateEMA(gains, params.period);
  const avgLosses = this.calculateEMA(losses, params.period);

  const rsi = avgGains.map((gain, i) => {
    if (avgLosses[i] === 0) return 100;
    const rs = gain / avgLosses[i];
    return 100 - (100 / (1 + rs));
  });

  return { values: rsi, metadata: {...} };
}
```

**ä¿¡å·è§„åˆ™**:
- RSI > 70: è¶…ä¹°ä¿¡å· (SELL)
- RSI < 30: è¶…å–ä¿¡å· (BUY)
- RSI 30-70: ä¸­æ€§åŒºé—´ (HOLD)

### ğŸ“ˆ MACD (æŒ‡æ•°å¹³æ»‘ç§»åŠ¨å¹³å‡æ”¶æ•›å‘æ•£)

**ç®—æ³•å®ç°**:
```typescript
calculate(data: OHLCV[], params: {fastPeriod: 12, slowPeriod: 26, signalPeriod: 9}) {
  const prices = this.getClosePrices(data);
  const fastEMA = this.calculateEMA(prices, params.fastPeriod);
  const slowEMA = this.calculateEMA(prices, params.slowPeriod);

  const macdLine = fastEMA.map((fast, i) => fast - slowEMA[i]);
  const signalLine = this.calculateEMA(macdLine, params.signalPeriod);
  const histogram = macdLine.map((macd, i) => macd - signalLine[i]);

  return {
    values: macdLine,
    signal: signalLine,
    histogram: histogram,
    metadata: {...}
  };
}
```

**ä¿¡å·è§„åˆ™**:
- MACDçº¿ä¸Šç©¿ä¿¡å·çº¿: ä¹°å…¥ä¿¡å·
- MACDçº¿ä¸‹ç©¿ä¿¡å·çº¿: å–å‡ºä¿¡å·
- æŸ±çŠ¶å›¾æ­£è´Ÿè½¬æ¢: åŠ¨é‡å˜åŒ–ç¡®è®¤

### ğŸ¯ å¸ƒæ—å¸¦ (Bollinger Bands)

**ç®—æ³•å®ç°**:
```typescript
calculate(data: OHLCV[], params: {period: 20, multiplier: 2}) {
  const prices = this.getClosePrices(data);
  const sma = this.calculateSMA(prices, params.period);
  const stdDev = this.calculateStdDev(prices, params.period);

  const upperBand = sma.map((avg, i) => avg + stdDev[i] * params.multiplier);
  const lowerBand = sma.map((avg, i) => avg - stdDev[i] * params.multiplier);

  return {
    values: sma,        // ä¸­è½¨
    upper: upperBand,   // ä¸Šè½¨
    lower: lowerBand,   // ä¸‹è½¨
    metadata: {...}
  };
}
```

**ä¿¡å·è§„åˆ™**:
- ä»·æ ¼è§¦åŠä¸Šè½¨: è¶…ä¹°è­¦å‘Š
- ä»·æ ¼è§¦åŠä¸‹è½¨: è¶…å–æœºä¼š
- è½¨é“æ”¶çª„: çªç ´å‰å…†
- è½¨é“æ‰©å¼ : è¶‹åŠ¿ç¡®è®¤

---

## ä¿¡å·åˆ†ææµç¨‹

### ğŸ” ç»¼åˆä¿¡å·åˆ†æç®—æ³•

```typescript
async analyzeCompositeSignal(
  signals: {[indicatorName: string]: SignalResult},
  symbolPair: string,
  timeframe: TimeFrame,
  strategy: string = 'balanced'
): Promise<CompositeSignal> {

  // 1. è·å–åˆ†æç­–ç•¥
  const analysisStrategy = this.strategies.get(strategy);

  // 2. è®¡ç®—åŠ æƒå¾—åˆ†
  const weightedScore = this.calculateWeightedScore(signals, analysisStrategy, timeframe);

  // 3. ç¡®å®šæ•´ä½“ä¿¡å·
  const overallSignal = this.determineOverallSignal(weightedScore);

  // 4. è®¡ç®—ä¿¡å·ç­‰çº§
  const grade = this.calculateSignalGrade(weightedScore, signals);

  // 5. ç”Ÿæˆç»¼åˆä¿¡å·
  return {
    overallSignal,
    score: weightedScore,
    grade,
    signals,
    metadata: {
      timestamp: Date.now(),
      symbolPair,
      timeframe,
      analysisCount: Object.keys(signals).length
    }
  };
}
```

### ğŸ“Š è¯„åˆ†ä½“ç³»

**ä¿¡å·å¾—åˆ†æ˜ å°„**:
```typescript
const SIGNAL_SCORES = {
  STRONG_BUY: 100,
  BUY: 50,
  HOLD: 0,
  SELL: -50,
  STRONG_SELL: -100
};
```

**æƒé‡è®¡ç®—å…¬å¼**:
```
æœ€ç»ˆå¾—åˆ† = Î£(æŒ‡æ ‡å¾—åˆ† Ã— æŒ‡æ ‡æƒé‡ Ã— å¯é æ€§ç³»æ•° Ã— æ—¶é—´æ¡†æ¶ç³»æ•°)
```

**ç­‰çº§åˆ’åˆ†**:
- **Açº§** (â‰¥80åˆ†): å¼ºçƒˆä¿¡å·ï¼Œé«˜ç½®ä¿¡åº¦
- **Bçº§** (60-79åˆ†): æ˜ç¡®ä¿¡å·ï¼Œä¸­é«˜ç½®ä¿¡åº¦
- **Cçº§** (40-59åˆ†): ä¸€èˆ¬ä¿¡å·ï¼Œä¸­ç­‰ç½®ä¿¡åº¦
- **Dçº§** (20-39åˆ†): å¼±ä¿¡å·ï¼Œä½ç½®ä¿¡åº¦
- **Fçº§** (<20åˆ†): æ— æ•ˆä¿¡å·ï¼Œå»ºè®®è§‚æœ›

---

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### âš¡ æ‰¹å¤„ç†ç³»ç»Ÿ

**BatchProcessoræ ¸å¿ƒç‰¹æ€§**:
```typescript
class BatchProcessor {
  // é˜Ÿåˆ—é…ç½®
  private config = {
    maxBatchSize: 20,           // æœ€å¤§æ‰¹æ¬¡å¤§å°
    maxWaitTime: 100,           // æœ€å¤§ç­‰å¾…æ—¶é—´(ms)
    maxConcurrentBatches: 3,    // æœ€å¤šå¹¶å‘æ‰¹æ¬¡
    priorityWeights: {          // ä¼˜å…ˆçº§æƒé‡
      high: 10,
      medium: 5,
      low: 1
    }
  };

  // æ‰¹å¤„ç†æµç¨‹
  async processBatch(tasks: BatchTask[]): Promise<BatchResult[]> {
    // æŒ‰ç±»å‹åˆ†ç»„
    const grouped = this.groupTasksByType(tasks);

    // å¹¶è¡Œå¤„ç†ä¸åŒç±»å‹
    const promises = [
      this.processOHLCVTasks(grouped.ohlcv),
      this.processIndicatorTasks(grouped.indicator),
      this.processSignalTasks(grouped.signal),
      this.processCompositeTasks(grouped.composite)
    ];

    return Promise.allSettled(promises);
  }
}
```

**æ€§èƒ½æå‡**:
- **ååé‡æå‡**: 40%+ çš„å¹¶å‘å¤„ç†èƒ½åŠ›
- **å»¶è¿Ÿé™ä½**: æ‰¹å¤„ç†å‡å°‘å•æ¬¡è¯·æ±‚å»¶è¿Ÿ
- **èµ„æºä¼˜åŒ–**: æ›´å¥½çš„CPUå’Œå†…å­˜åˆ©ç”¨ç‡

### ğŸ“Š æ€§èƒ½ç›‘æ§

**PerformanceOptimizeråŠŸèƒ½**:
```typescript
interface PerformanceMetrics {
  cacheHitRate: number;           // ç¼“å­˜å‘½ä¸­ç‡
  averageResponseTime: number;    // å¹³å‡å“åº”æ—¶é—´
  memoryUsage: number;           // å†…å­˜ä½¿ç”¨é‡
  calculationsPerSecond: number;  // æ¯ç§’è®¡ç®—æ¬¡æ•°
  batchProcessingEfficiency: number; // æ‰¹å¤„ç†æ•ˆç‡
  errorRate: number;             // é”™è¯¯ç‡
}
```

**è‡ªåŠ¨ä¼˜åŒ–å»ºè®®**:
- ç¼“å­˜TTLè°ƒæ•´å»ºè®®
- æ‰¹å¤„ç†å¤§å°ä¼˜åŒ–
- å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- é¢„ç¼“å­˜ç­–ç•¥å»ºè®®

---

## ç¼“å­˜ç­–ç•¥è¯¦è§£

### ğŸ¯ åˆ†å±‚ç¼“å­˜è®¾è®¡

**ç¼“å­˜å±‚çº§ç»“æ„**:
```
Level 1: å†…å­˜ç¼“å­˜ (Map<string, CacheItem>)
â”œâ”€â”€ OHLCVæ•°æ®ç¼“å­˜ (45ç§’-7å¤©TTL)
â”œâ”€â”€ æŒ‡æ ‡è®¡ç®—ç»“æœ (30ç§’-7å¤©TTL)
â”œâ”€â”€ ä¿¡å·åˆ†æç»“æœ (20ç§’-4å¤©TTL)
â””â”€â”€ ç»¼åˆä¿¡å·ç¼“å­˜ (15ç§’-2å¤©TTL)
```

### â° æ™ºèƒ½TTLç­–ç•¥

**åŸºäºæ—¶é—´æ¡†æ¶çš„TTLé…ç½®**:
```typescript
const OPTIMIZED_TTL_CONFIG = {
  [CacheType.OHLCV]: {
    '1m': 45 * 1000,        // 1åˆ†é’Ÿæ•°æ®ç¼“å­˜45ç§’
    '5m': 3 * 60 * 1000,    // 5åˆ†é’Ÿæ•°æ®ç¼“å­˜3åˆ†é’Ÿ
    '15m': 8 * 60 * 1000,   // 15åˆ†é’Ÿæ•°æ®ç¼“å­˜8åˆ†é’Ÿ
    '1h': 30 * 60 * 1000,   // 1å°æ—¶æ•°æ®ç¼“å­˜30åˆ†é’Ÿ
    '4h': 2 * 60 * 60 * 1000, // 4å°æ—¶æ•°æ®ç¼“å­˜2å°æ—¶
    '1d': 8 * 60 * 60 * 1000  // æ—¥çº¿æ•°æ®ç¼“å­˜8å°æ—¶
  }
};
```

**TTLè®¾è®¡åŸåˆ™**:
1. **æ—¶é—´æ¡†æ¶è¶ŠçŸ­ï¼ŒTTLè¶ŠçŸ­**: ä¿è¯å®æ—¶æ€§
2. **æŒ‡æ ‡ç±»å‹è¶Šå¤æ‚ï¼ŒTTLè¶Šé•¿**: é¿å…é‡å¤è®¡ç®—
3. **çƒ­é—¨äº¤æ˜“å¯¹TTLé€‚å½“å»¶é•¿**: æé«˜å‘½ä¸­ç‡
4. **ç³»ç»Ÿè´Ÿè½½é«˜æ—¶åŠ¨æ€è°ƒæ•´**: å¹³è¡¡æ€§èƒ½ä¸å®æ—¶æ€§

### ğŸ§¹ ç¼“å­˜ç®¡ç†

**è‡ªåŠ¨æ¸…ç†ç­–ç•¥**:
- **å®šæ—¶æ¸…ç†**: æ¯2åˆ†é’Ÿæ¸…ç†è¿‡æœŸç¼“å­˜
- **LRUæ·˜æ±°**: å†…å­˜è¾¾åˆ°é™åˆ¶æ—¶æ™ºèƒ½æ·˜æ±°
- **ä¼˜å…ˆçº§ä¿æŠ¤**: é«˜ä¼˜å…ˆçº§æ•°æ®ä¼˜å…ˆä¿ç•™
- **å†…å­˜ç›‘æ§**: å®æ—¶ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ

---

## APIæ¥å£è¯´æ˜

### ğŸ¤– Telegram Botå‘½ä»¤

#### `/signals <äº¤æ˜“å¯¹> [æ—¶é—´æ¡†æ¶] [ç­–ç•¥]`

**å‚æ•°è¯´æ˜**:
- `äº¤æ˜“å¯¹`: å¿…å¡«ï¼Œå¦‚ BTC, ETH, BTCUSDT
- `æ—¶é—´æ¡†æ¶`: å¯é€‰ï¼Œé»˜è®¤1hï¼Œæ”¯æŒ 1m,5m,15m,30m,1h,4h,1d
- `ç­–ç•¥`: å¯é€‰ï¼Œé»˜è®¤balancedï¼Œæ”¯æŒ balanced,momentum,trend,conservative,aggressive

**ä½¿ç”¨ç¤ºä¾‹**:
```
/signals BTC          # æ¯”ç‰¹å¸1å°æ—¶å¹³è¡¡ç­–ç•¥åˆ†æ
/signals ETH 4h       # ä»¥å¤ªåŠ4å°æ—¶å¹³è¡¡ç­–ç•¥åˆ†æ
/signals BTCUSDT 15m momentum  # æ¯”ç‰¹å¸15åˆ†é’ŸåŠ¨é‡ç­–ç•¥åˆ†æ
```

**è¿”å›æ ¼å¼**:
```
ğŸ“Š BTC/USDT æŠ€æœ¯åˆ†æ (1h)

ğŸ’° å½“å‰ä»·æ ¼: $43,250.50 (+2.34%)
ğŸ“ˆ 24hæ¶¨è·Œ: +1,015.23 (+2.41%)
ğŸ’§ èµ„é‡‘è´¹ç‡: -0.0125% (8h)

ğŸ¯ ç»¼åˆè¯„åˆ†: 75/100 (Bçº§)
ğŸ“Š æ•´ä½“ä¿¡å·: ä¹°å…¥ ğŸŸ¢

ğŸ“‹ æŠ€æœ¯æŒ‡æ ‡è¯¦æƒ…:
â€¢ RSI(14): 45.2 â†’ ä¸­æ€§ âšª
â€¢ MACD: é‡‘å‰ â†’ ä¹°å…¥ ğŸŸ¢
â€¢ å¸ƒæ—å¸¦: ä¸­è½¨ä¸Šæ–¹ â†’ åå¤š ğŸŸ¢
â€¢ MAå‡çº¿: å¤šå¤´æ’åˆ— â†’ ä¹°å…¥ ğŸŸ¢

ğŸ’¡ å†³ç­–å»ºè®®: å»ºè®®é€¢ä½ä¹°å…¥ï¼Œæ­¢æŸè®¾åœ¨$42,000
âš ï¸ é£é™©æç¤º: æ³¨æ„å›è°ƒé£é™©ï¼Œå»ºè®®åˆ†æ‰¹å»ºä»“
```

### ğŸ”§ å†…éƒ¨APIæ¥å£

#### TechnicalIndicatorEngine

```typescript
// è®¡ç®—å•ä¸ªæŒ‡æ ‡
await engine.calculateIndicator('RSI', ohlcvData, {period: 14});

// è·å–ç»¼åˆä¿¡å·
await engine.getCompositeSignal(
  ['RSI', 'MACD', 'MA'],
  ohlcvData,
  'BTCUSDT',
  TimeFrame.H1
);
```

#### OHLCVDataService

```typescript
// è·å–Kçº¿æ•°æ®
await service.getOHLCVData('BTCUSDT', TimeFrame.H1, 100);

// å¤šæ—¶é—´æ¡†æ¶æ•°æ®
await service.getMultiTimeframeData('BTCUSDT', [
  TimeFrame.M15, TimeFrame.H1, TimeFrame.H4
]);
```

---

## ä½¿ç”¨ç¤ºä¾‹

### ğŸ“ åŸºæœ¬ä½¿ç”¨æµç¨‹

```typescript
// 1. è·å–æœåŠ¡å®ä¾‹
const indicatorEngine = container.resolve(SERVICE_IDENTIFIERS.TECHNICAL_INDICATOR_ENGINE);
const ohlcvService = container.resolve(SERVICE_IDENTIFIERS.OHLCV_DATA_SERVICE);
const signalAnalyzer = container.resolve(SERVICE_IDENTIFIERS.SIGNAL_ANALYZER);

// 2. åˆå§‹åŒ–æœåŠ¡
await indicatorEngine.initialize();
await ohlcvService.initialize();
await signalAnalyzer.initialize();

// 3. è·å–å¸‚åœºæ•°æ®
const ohlcvData = await ohlcvService.getOHLCVData('BTCUSDT', TimeFrame.H1, 200);

// 4. è®¡ç®—æŠ€æœ¯æŒ‡æ ‡
const rsiResult = await indicatorEngine.calculateIndicator('RSI', ohlcvData, {period: 14});
const macdResult = await indicatorEngine.calculateIndicator('MACD', ohlcvData);

// 5. è·å–ç»¼åˆåˆ†æ
const composite = await indicatorEngine.getCompositeSignal(
  ['RSI', 'MACD', 'MA'],
  ohlcvData,
  'BTCUSDT',
  TimeFrame.H1
);

console.log('ç»¼åˆä¿¡å·:', composite.overallSignal);
console.log('è¯„åˆ†ç­‰çº§:', composite.grade);
```

### ğŸ”„ æ‰¹å¤„ç†ä½¿ç”¨ç¤ºä¾‹

```typescript
const batchProcessor = new BatchProcessor();

// æ·»åŠ æ‰¹å¤„ç†ä»»åŠ¡
const taskIds = batchProcessor.addTasks([
  {
    type: 'indicator',
    symbol: 'BTCUSDT',
    timeframe: TimeFrame.H1,
    indicatorName: 'RSI',
    priority: 'high'
  },
  {
    type: 'signal',
    symbol: 'ETHUSDT',
    timeframe: TimeFrame.M15,
    indicatorName: 'MACD',
    priority: 'medium'
  }
]);

// ç­‰å¾…ç»“æœ
const results = await batchProcessor.waitForResults(taskIds);
```

---

## éƒ¨ç½²ä¸é…ç½®

### ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

```json
{
  "node": ">=16.0.0",
  "npm": ">=7.0.0",
  "dependencies": {
    "typescript": "^4.9.0",
    "inversify": "^6.0.1",
    "reflect-metadata": "^0.1.13"
  }
}
```

### âš™ï¸ é…ç½®æ–‡ä»¶

**tsconfig.json å…³é”®é…ç½®**:
```json
{
  "compilerOptions": {
    "experimentalDecorators": true,
    "emitDecoratorMetadata": true,
    "exactOptionalPropertyTypes": true
  }
}
```

**ç¯å¢ƒå˜é‡**:
```bash
# å¸å®‰APIé…ç½®
BINANCE_API_KEY=your_api_key
BINANCE_SECRET_KEY=your_secret_key

# æ€§èƒ½é…ç½®
CACHE_MAX_SIZE=15000
BATCH_MAX_SIZE=20
PERFORMANCE_MONITORING=true

# Telegramé…ç½®
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_USER_ID=your_user_id
```

### ğŸš€ å¯åŠ¨æµç¨‹

```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. ç¼–è¯‘TypeScript
npm run build

# 3. å¯åŠ¨åº”ç”¨
npm start

# æˆ–å¼€å‘æ¨¡å¼
npm run dev
```

### ğŸ“‹ æœåŠ¡æ³¨å†Œæ£€æŸ¥

ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨éªŒè¯æ‰€æœ‰æœåŠ¡æ³¨å†Œï¼š

```typescript
// éªŒè¯æœåŠ¡æ³¨å†Œ
const validation = registry.validate();
if (!validation.valid) {
  console.error('æœåŠ¡æ³¨å†ŒéªŒè¯å¤±è´¥:', validation.errors);
  process.exit(1);
}
```

---

## æ•…éšœæ’é™¤

### âŒ å¸¸è§é—®é¢˜

#### 1. **æœåŠ¡è§£æå¤±è´¥**
```
Error: Service not registered: TechnicalIndicatorEngine
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥ServiceRegistry.tsä¸­æœåŠ¡æ˜¯å¦æ­£ç¡®æ³¨å†Œ

#### 2. **APIé™åˆ¶é”™è¯¯**
```
Error: Request weight exceeded
```
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥API Keyæƒé™
- è°ƒæ•´è¯·æ±‚é¢‘ç‡
- å¯ç”¨è¯·æ±‚ç¼“å­˜

#### 3. **å†…å­˜ä½¿ç”¨è¿‡é«˜**
```
Warning: Memory usage exceeds 400MB
```
**è§£å†³æ–¹æ¡ˆ**:
- è°ƒæ•´ç¼“å­˜å¤§å°é™åˆ¶
- å¯ç”¨LRUæ·˜æ±°ç­–ç•¥
- æ£€æŸ¥å†…å­˜æ³„æ¼

#### 4. **ç¼“å­˜å‘½ä¸­ç‡ä½**
```
Warning: Cache hit rate below 60%
```
**è§£å†³æ–¹æ¡ˆ**:
- è°ƒæ•´TTLé…ç½®
- æ£€æŸ¥ç¼“å­˜é”®ç”Ÿæˆé€»è¾‘
- åˆ†æè®¿é—®æ¨¡å¼

### ğŸ” è°ƒè¯•æŠ€å·§

#### å¯ç”¨è¯¦ç»†æ—¥å¿—
```bash
export LOG_LEVEL=debug
npm start
```

#### æ€§èƒ½ç›‘æ§
```typescript
// è·å–æ€§èƒ½æŠ¥å‘Š
const optimizer = container.resolve('PerformanceOptimizer');
const report = optimizer.getPerformanceReport();
console.log('æ€§èƒ½æŠ¥å‘Š:', report);
```

#### ç¼“å­˜ç»Ÿè®¡
```typescript
// æŸ¥çœ‹ç¼“å­˜çŠ¶æ€
const cacheService = container.resolve(SERVICE_IDENTIFIERS.INDICATOR_CACHE_SERVICE);
const stats = cacheService.getStats();
console.log('ç¼“å­˜ç»Ÿè®¡:', stats);
```

---

## ğŸ”® åç»­å‘å±•è®¡åˆ’

### çŸ­æœŸç›®æ ‡ (1-2ä¸ªæœˆ)
- [ ] æ·»åŠ æ›´å¤šæŠ€æœ¯æŒ‡æ ‡ (KDJ, Williams %R, ATR)
- [ ] ä¼˜åŒ–æ‰¹å¤„ç†æ€§èƒ½
- [ ] å®ç°æŒ‡æ ‡å‚æ•°è‡ªåŠ¨ä¼˜åŒ–
- [ ] æ·»åŠ å›æµ‹åŠŸèƒ½

### ä¸­æœŸç›®æ ‡ (3-6ä¸ªæœˆ)
- [ ] æœºå™¨å­¦ä¹ ä¿¡å·ä¼˜åŒ–
- [ ] å¤šäº¤æ˜“æ‰€æ•°æ®æ”¯æŒ
- [ ] å®æ—¶WebSocketæ•°æ®æµ
- [ ] ç§»åŠ¨ç«¯æ¨é€é€šçŸ¥

### é•¿æœŸç›®æ ‡ (6-12ä¸ªæœˆ)
- [ ] ç®—æ³•äº¤æ˜“ä¿¡å·
- [ ] é£é™©ç®¡ç†ç³»ç»Ÿ
- [ ] ç¤¾äº¤äº¤æ˜“åŠŸèƒ½
- [ ] é‡åŒ–ç­–ç•¥å¹³å°

---

**ğŸ“ æŠ€æœ¯æ”¯æŒ**

å¦‚æœ‰æŠ€æœ¯é—®é¢˜æˆ–æ”¹è¿›å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿæˆ–æäº¤Issueã€‚

**ğŸ“„ ç‰ˆæœ¬å†å²**

- v2.3.0: æŠ€æœ¯æŒ‡æ ‡ç³»ç»Ÿå®Œæ•´å®ç°
- v2.2.0: æ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜ç­–ç•¥
- v2.1.0: åŸºç¡€æ¶æ„æ­å»º
- v2.0.0: ç³»ç»Ÿé‡æ„å’ŒDIå¼•å…¥

---

*æœ€åæ›´æ–°: 2025-09-18*
*æ–‡æ¡£ç‰ˆæœ¬: v1.0*